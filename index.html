<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Molly Bot</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white p-10 text-center">
    
    <div id="login-screen">
        <h1 class="text-3xl mb-5">Dashboard da Molly</h1>
        <button onclick="window.location.href='/api/auth'" class="bg-indigo-600 p-4 rounded-lg font-bold">Clique aqui para Logar</button>
    </div>

    <div id="dashboard" class="hidden max-w-md mx-auto bg-gray-800 p-6 rounded-xl">
        <img id="avatar" class="w-24 h-24 rounded-full mx-auto mb-4 border-4 border-indigo-500">
        <h2 id="name" class="text-xl font-bold mb-4"></h2>
        
        <input type="text" id="channel-id" placeholder="ID do Canal" class="w-full p-2 bg-gray-700 rounded mb-4">
        <button onclick="enviarMensagem()" class="w-full bg-green-600 p-2 rounded font-bold">Enviar Mensagem de Teste</button>
    </div>

    <script>
        const params = new URLSearchParams(window.location.search);
        const token = params.get('token');

        if (token) {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('dashboard').classList.remove('hidden');
            
            // Buscar foto de perfil
            fetch('https://discord.com/api/users/@me', {
                headers: { Authorization: `Bearer ${token}` }
            })
            .then(res => res.json())
            .then(user => {
                document.getElementById('name').innerText = user.username;
                document.getElementById('avatar').src = `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png`;
            });
        }

        async function enviarMensagem() {
            const channel = document.getElementById('channel-id').value;
            // Conecta com o IP do seu Bot Hosting
            const response = await fetch('http://fi4.bot-hosting.net:20956/send-message', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    channelId: channel,
                    content: "Molly ativa! Mensagem vinda do site. üçã"
                })
            });
            if (response.ok) alert("Mensagem enviada pelo Bot!");
            else alert("Erro ao conectar com o bot.");
        }
    </script>
</body>
</html>
